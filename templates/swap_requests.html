{% extends "base.html" %}
{% block content %}
<div class="min-h-screen bg-gradient-to-br from-indigo-100 via-purple-100 to-pink-100 py-12 px-4 sm:px-6 lg:px-8 flex items-center justify-center dark:bg-gray-900">
  <div class="max-w-6xl w-full bg-white shadow-2xl rounded-3xl p-10 border border-indigo-200 dark:bg-gray-800 dark:border-gray-700">
    <h2 class="text-3xl font-extrabold text-center text-indigo-700 mb-10 drop-shadow">My Swap Requests</h2>

    <!-- RECEIVED REQUESTS -->
    <div class="mb-12">
      <h3 class="text-2xl font-semibold text-indigo-500 mb-6 flex items-center gap-2">
        <svg class="w-6 h-6 text-indigo-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        Received Requests
      </h3>
      {% if received %}
      <ul class="space-y-4">
        {% for req in received %}
        <li class="bg-gradient-to-r from-indigo-50 via-purple-50 to-pink-50 rounded-xl shadow-md p-4 flex items-center justify-between flex-wrap md:flex-nowrap gap-4 border border-indigo-100 hover:shadow-lg transition">
          <div class="flex items-center gap-4 flex-1">
            <img class="w-12 h-12 rounded-full border-2 border-indigo-200 shadow" src="https://api.dicebear.com/7.x/adventurer/svg?seed={{ req.requester.name }}" alt="avatar">
            <div>
              <div class="font-semibold text-indigo-700">From: {{ req.requester.name }}</div>
              <div class="text-sm text-gray-600">Skill: <span class="bg-green-200 text-green-900 px-2 py-0.5 rounded-full font-medium">{{ req.skill }}</span></div>
              <div class="text-sm text-gray-500">Status: 
                <span class="font-semibold {% if req.status == 'Accepted' %}text-green-600{% elif req.status == 'Rejected' %}text-red-600{% else %}text-yellow-600{% endif %}">
                  {{ req.status }}
                </span>
              </div>
            </div>
          </div>
          {% if req.status == 'Pending' %}
          <div class="flex gap-2">
            <a href="{{ url_for('respond_swap', swap_id=req.id, action='accept') }}"
               class="px-4 py-1 bg-green-500 hover:bg-green-600 text-white rounded-full text-sm font-semibold shadow transition">
              Accept
            </a>
            <a href="{{ url_for('respond_swap', swap_id=req.id, action='reject') }}"
               class="px-4 py-1 bg-red-500 hover:bg-red-600 text-white rounded-full text-sm font-semibold shadow transition">
              Reject
            </a>
          </div>
          {% endif %}
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p class="text-gray-600 italic text-center">No requests received.</p>
      {% endif %}
    </div>

    <!-- SENT REQUESTS -->
    <div>
      <h3 class="text-2xl font-semibold text-indigo-500 mb-6 flex items-center gap-2">
        <svg class="w-6 h-6 text-purple-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a4 4 0 00-3-3.87M9 20H4v-2a4 4 0 013-3.87M16 3.13a4 4 0 010 7.75M8 3.13a4 4 0 000 7.75" />
        </svg>
        Sent Requests
      </h3>
      {% if sent %}
      <ul class="space-y-4">
        {% for req in sent %}
        <li class="bg-gradient-to-r from-indigo-50 via-purple-50 to-pink-50 rounded-xl shadow-md p-4 flex items-center justify-between flex-wrap md:flex-nowrap gap-4 border border-indigo-100 hover:shadow-lg transition">
          <div class="flex items-center gap-4 flex-1">
            <img class="w-12 h-12 rounded-full border-2 border-purple-200 shadow" src="https://api.dicebear.com/7.x/adventurer/svg?seed={{ req.receiver.name }}" alt="avatar">
            <div>
              <div class="font-semibold text-indigo-700">To: {{ req.receiver.name }}</div>
              <div class="text-sm text-gray-600">Skill: <span class="bg-yellow-200 text-yellow-900 px-2 py-0.5 rounded-full font-medium">{{ req.skill }}</span></div>
              <div class="text-sm text-gray-500">Status: 
                <span class="font-semibold {% if req.status == 'Accepted' %}text-green-600{% elif req.status == 'Rejected' %}text-red-600{% else %}text-yellow-600{% endif %}">
                  {{ req.status }}
                </span>
              </div>
            </div>
          </div>
          <div class="text-sm">
            {% if req.status == 'Accepted' and not req.feedback %}
            <a href="{{ url_for('leave_feedback', swap_id=req.id) }}"
               class="px-4 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded-full text-sm font-semibold shadow transition">
              Leave Feedback
            </a>
            {% elif req.feedback %}
            <span class="text-green-700 font-semibold flex items-center gap-1">
              <svg class="w-4 h-4 inline" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
              </svg>
              Feedback Sent
            </span>
            {% endif %}
          </div>
        </li>
        {% endfor %}
      </ul>
      {% else %}
      <p class="text-gray-600 italic text-center">No requests sent.</p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
